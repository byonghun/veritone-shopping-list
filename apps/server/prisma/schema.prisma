// Within apps/server run this command
// npm run prisma:migrate:dev - --name <schema name>
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Item {
  id          String   @id @default(cuid())
  itemName    String
  description String?
  quantity    Int      @default(1)
  purchased   Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model User {
  id             String    @id @default(cuid())
  email          String
  // Always write and query the lowercase+trimmed email version
  emailCanonical String    @unique // Gives fast lookups and prevents case/space duplicates
  passwordHash   String // stores the Argon2 hash (never the password)
  roles          String[]  @default([]) // Flexiblity for futre RBAC (Role Based Access Control)
  isGuest        Boolean   @default(false) // guest users
  lastLoginAt    DateTime? // Supports onSuccessfulLogin hook
  createdAt      DateTime  @default(now())
  updatedAt      DateTime  @updatedAt

  // TODO: Add session rotation feature using refreshTokens
  // refreshTokens RefreshToken[]

  @@index([email]) // optional, for ops/queries (operational/administrative lookups)
}
